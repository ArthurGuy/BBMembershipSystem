language: php
php:
- 5.5
before_script:
- travis_retry composer self-update
- travis_retry composer install --prefer-source --no-interaction
- mysql -e 'create database bbms_acceptance_testing;'
script: vendor/bin/codecept run  --coverage-xml
after_script:
   - wget https://scrutinizer-ci.com/ocular.phar
   - php ocular.phar code-coverage:upload --format=php-clover app/tests/codeception/_output/coverage.xml
after_success:
   - curl https://api.rollbar.com/api/1/deploy/ --silent -F access_token=A4MSneQD2TA/xpuxAKW+FvHrriyYk3+VB6Duym7URFRvuja14HA02Yo1XuLqJ6gHIDFiWhMG+azOHAXNtnhofiUWUxvi76TtBQ4ykl0QLTo9BHUwu00AcavMmXf/Dc0A7I2Ixawd3ROnB/Lz5kT4A6zuV1219iThfgz2wUIyeUM= -F environment=production -F revision=#TRAVIS_COMMIT
notifications:
  email: false
  webhooks:
    urls:
    - https://forge.laravel.com/servers/6535/sites/13543/deploy/http?token=xQRcFZIu84lgF0M4td5w6fj5vqmyDpCY3KY8SBcT
    on_success: always
    on_failure: never
  slack:
    secure: h4TcrEDPz8p92zFEXVu9IjmjfQhRnrbWas9sOE95pinxhOTe5DQ77fFetifDXeExCMmCKgVmJcQtJMmvx3oEUfTTyIxfdUGw+/uTk/X/wY2204IIL/WVxuBVGSKh4dt6BENLm8dZKDIeFsQxhUHdsH8gTBNlKJv+3Tht9vsDoK8=
